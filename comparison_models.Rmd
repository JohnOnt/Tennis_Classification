---
title: "Comparison Models"
author: "Johnattan Ontiveros"
date: "4/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=F}
library("BradleyTerry2")
library("data.table")
library("tidyverse")
library('aod')
```
```{r}
ATP_table <- read.csv('ATP_Cont_Table.csv')
ATP_table <- ATP_table[-c(1)]
rownames(ATP_table) <- colnames(ATP_table)

head(ATP_table)
```
```{r}
bt_data.sf = countsToBinomial(ATP_table)

bt_data.sf
```
```{r}
btModel <- BTm(cbind(win1, win2), player1, player2, data=bt_data.sf)
```

```{r}
summary(btModel)
```
# Now time to do the logistic regression model on the ELO data first and then include the data with the classified players and see if any of my work for the past days and hours is worth anything

```{r}
elo_wins <- read.csv('elo_wins.csv')
elo_wins$winner <- as.factor(elo_wins$winner)
elo_wins$winner_class <- as.factor(elo_wins$winner_class)
elo_wins$loser_class <- as.factor(elo_wins$loser_class)

head(elo_wins)
```

```{r}
glm_0 <- glm(winner ~ 1, data = elo_wins, family = "binomial")
summary(glm_0)
```
```{r}
glm_elo <- glm(winner ~ elo_diff, data = elo_wins, family = "binomial")
summary(glm_elo)
```
```{r}
anova(glm_0, glm_elo, test='Chi')
```

```{r}
glm_class <- glm(winner ~ elo_diff + winner_class + loser_class, data = elo_wins, family = "binomial")
glm_just_class <- glm(winner ~ winner_class * loser_class, data = elo_wins, family = "binomial")

summary(glm_class)
summary(glm_just_class)
```
```{r}
anova(glm_elo, glm_class, test = 'Chi')
```

```{r}

#ones <- rep(1, nrow(elo_wins))
#bb_elo <- betabin(cbind(winner, ones) ~ elo_diff, ~ 1,
#                  link = 'logit', data = elo_wins)

#summary(bb_elo)
```