---
title: "Comparison Models"
author: "Johnattan Ontiveros"
date: "4/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=F}
library("BradleyTerry2")
library("data.table")
library("tidyverse")
```
```{r}
matchups100 <- read.csv('matchups_atp100.csv')
matchups100 <- matchups100[-c(1)]
rownames(matchups100) <- colnames(matchups100)

head(matchups100)
```
```{r}
n = dim(matchups100)[1]
players = colnames(matchups100)
df_length = 4005 #(factorial(n)) #/ (factorial(2) * factorial(n - 2))

bt_data <- as.data.frame(matrix(0, (df_length), 4))
colnames(bt_data) <- c("p1", "p2", "win1", "win2")
bt_data$p1 <- as.character(bt_data$p1)
bt_data$p2 <- as.character(bt_data$p2)

for (i in seq(1,n)) {
  for (j in seq(i,n)) {
    row_ind = n*(i-1) + j - 1
    p1 <- as.character(players[i])
    p2 <- as.character(players[j])
    
    bt_data[row_ind,] <- c(p1, p2, matchups100[p2, p1], matchups100[p1, p2])
  }
}

```

```{r}
bt_data$p1 <- factor(bt_data$p1, levels=players)
bt_data$p2 <- factor(bt_data$p2, levels=players)
bt_data$win1 <- as.numeric(bt_data$win1)
bt_data$win2 <- as.numeric(bt_data$win2)
bt_data = drop_na(bt_data)
head(bt_data)
tail(bt_data)
```
```{r}
bt_data.sf = countsToBinomial(matchups100)

bt_data.sf
```
```{r}
#btModel <- BTm(cbind(win1, win2), player1, player2, data=bt_data.sf)
btModel <- BTm(1, win1, win2, ~ player1, player2, data=bt_data.sf)
#btModel <- BTm(cbind(win1, win2), p1, p2, data=bt_data)
```

```{r}
data("citations", package= "BradleyTerry2")

citations.sf <- countsToBinomial(citations)
names(citations.sf)[1:2] <- c("journal1", "journal2")
citations.sf
```


