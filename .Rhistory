print(x)
plot(cars)
rbern(4, 0.5)
install.packages('Rlab')
rbern(4, 0.5)
library(Rlab)
rbern(4, 0.5)
rbern(5, 2/3)
rbern(10, 2/3)
x <- rbern(20, 2/3)
library(Rlab)
x <- rbern(20, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(200, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(1000, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(20, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(50, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(100, 2/3)
sum(x)
mean(x)
library(Rlab)
x <- rbern(1000, 2/3)
sum(x)
mean(x)
install.packages("faraway")
library(faraway)
contr.sum(5)
summary(spector)
xtabs(~grade+psi, spector)
summary(spector)
xtabs(~grade+psi, spector)
spector$psi = factor(spector$psi)
glm(grade ~ psi + tuce + gpa, family=binomial, data=spector)
glm1 <- glm(grade ~ psi + tuce + gpa, family=binomial, data=spector)
confint(glm1)
glm1 <- glm(grade ~ psi + tuce + gpa, family=binomial, data=spector)
confint(glm1)
summary(glm1)
glm2 <- glm(grade ~ psi, family=binomial, data=spector)
summary(glm2)
1 / (1 + exp(1.61 - 1.90))
summary(spector)
xtabs(~grade+psi, spector)
spector$psi = factor(spector$psi)
8 / (8+6)
glm3 <- glm(grade ~ psi + tuce + gpa, family=binomial(probit), data=spector)
glm3 <- glm(grade ~ psi + tuce + gpa, family=binomial(probit), data=spector)
summary(glm3)
glm3 <- glm(grade ~ psi + tuce + gpa, family=binomial(probit), data=spector)
summary(glm3)
confint(glm3)
student.0 <- data.frame(psi=1, tuce=20, gpa=3.3)
student.1 <- data.frame(psi=1, tuce=20, gpa=3.3)
predict(glm1, newdata = student.0, type='link')
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi=1, tuce=20, gpa=3.3)
predict(glm1, newdata = student.0, type='link')
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
predict(glm1, newdata = student.0, type='link')
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link')
s0_pred
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s0_pred
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s0_pred$fit + 1.96 s0_pred$se.fit
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s0_pred$fit + 1.96 * s0_pred$se.fit
student.0 <- data.frame(psi='1', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm3, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm3, newdata = student.1, type='link', se.fit=T)
pnorm( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
pnorm( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
summary(glm1)$cov.unscaled
library(faraway)
contr.sum(5)
summary(spector)
xtabs(~grade+psi, spector)
spector$psi = factor(spector$psi)
8 / (8+6)
glm1 <- glm(grade ~ psi + tuce + gpa, family=binomial, data=spector)
confint(glm1)
summary(glm1)
exp(0.4786)
exp(0.4786)
exp(4.81)
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
s0_pred
s1_pred
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
s0_pred$fit
s1_pred$fit
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
plogis(s0_pred$fit)
plogis(s1_pred$fit)
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta
varbeta <- summary(glm1)$cov.unscaled
# student.1 %*% varbeta
student.1
student.1 <- data.frame(psi=1, tuce=20, gpa=3.3)
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta
student.1 <- c(1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
varbeta
#student.1 %*% varbeta
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
varbeta
student.1 %*% varbeta
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta %*% t(student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta #%*% t(student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
t(student.1)
student.1 %*% varbeta #%*% t(student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta %*% t(student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
student.1 %*% varbeta %*% (student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
sqrt(student.1 %*% varbeta %*% student.1)
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
plogis(s0_pred$fit)
plogis(s1_pred$fit)
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit)
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm1, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm1, newdata = student.1, type='link', se.fit=T)
plogis(s0_pred$fit)
plogis(s1_pred$fit)
plogis( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
plogis( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
p <- plogis(student.1$fit)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
p <- plogis(s1_pred$fit)
p * (1-p) * sqrt(student.1 %*% varbeta %*% student.1)
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
p <- plogis(s1_pred$fit)
p * (1-p) * sqrt(student.1 %*% varbeta %*% student.1)
s1_pred2 <- predict(glm3, newdata = student.1, type='response', se.fit=T)$se.fit
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm3, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm3, newdata = student.1, type='link', se.fit=T)
pnorm( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
pnorm( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.0 <- data.frame(psi='0', tuce=20, gpa=3.3)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s0_pred <- predict(glm3, newdata = student.0, type='link', se.fit=T)
s1_pred <- predict(glm3, newdata = student.1, type='link', se.fit=T)
pnorm(s0_pred$fit)
pnorm(s1_pred$fit)
pnorm( c(
s0_pred$fit - 1.96 * s0_pred$se.fit,
s0_pred$fit + 1.96 * s0_pred$se.fit))
pnorm( c(
s1_pred$fit - 1.96 * s1_pred$se.fit,
s1_pred$fit + 1.96 * s1_pred$se.fit))
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
p <- plogis(s1_pred$fit)
p * (1-p) * sqrt(student.1 %*% varbeta %*% student.1)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s1_pred2 <- predict(glm3, newdata = student.1, type='response', se.fit=T)$se.fit
student.1 <- c(1, 1, 20, 3.3)
varbeta <- summary(glm1)$cov.unscaled
p <- plogis(s1_pred$fit)
p * (1-p) * sqrt(student.1 %*% varbeta %*% student.1)
student.1 <- data.frame(psi='1', tuce=20, gpa=3.3)
s1_pred2 <- predict(glm3, newdata = student.1, type='response', se.fit=T)
s1_pred2$se.fit
data <- read.csv('league_summary_19_20.csv')
head(data)
knitr::opts_chunk$set(echo = TRUE)
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
knitr::opts_chunk$set(echo = TRUE)
library(faraway)
summary(pima)
mypima = pima
mypima = mypima[mypima$glucose > 0, ]
mypima = mypima[mypima$diastolic > 0, ]
mypima = mypima[mypima$triceps > 0, ]
mypima = mypima[mypima$insulin > 0, ]
mypima = mypima[mypima$bmi > 0, ]
nrow(pima)
nrow(mypima)
pima.glm <- glm(test ~ ., family=binomial, data=mypima)
summary(pima.glm)$coef
pima.vif.lm <- lm(test ~ ., data=mypima)
vif(pima.vif.lm)
hosmerlem <- function (y, yhat, g=10) {
cutyhat = cut(yhat, breaks = quantile(yhat, probs = seq(0,1, 1/g)), include.lowest = T)
obs = xtabs(cbind(1-y, y) ~ cutyhat)
expect = xtabs(cbind(1 - yhat, yhat) ~ cutyhat)
chisq = sum((obs - expect)^2/expect)
P = 1 - pchisq(chisq, g - 2)
c("X^2" = chisq, Df = g - 2, "P(>Chi)" = P)
}
hosmerlem(pima.glm$y, fitted(pima.glm))
#resids_jack <- rstudent(pima.glm)
#fitted_vals <- fitted(pima.glm)
#plot(fitted_vals, resids_jack)
arm::binnedplot(fitted(pima.glm), residuals(pima.glm, type="response"),
xlab="Averaged fitted probabilities",
ylab="Averaged residuals",
pch=19, col.pts="red", cex.pts=1.5,
main="Binned residuals vs. fitted plot")
plot(cooks.distance(pima.glm), type="h", lwd=2,
xlab="Observation index",
ylab="Cook's distances",
main="Cook's distances for pima data")
abline(h=1, lty=2, col="red")
options(contrasts = c("contr.treatment", "contr.treatment"))
glm.cancer <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp + tobgp, family=binomial, data=esoph)
summary(glm.cancer)$coef
exp(3.72) / (1 + exp(3.72))
# odds ratio
exp(0.3407)
# Confint
c(exp(0.3407 - 1.96*1.03), exp(0.3407 + 1.96*1.03))
exp(-5.91) / (1 + exp(-5.91))
glm.cancer_no_age <- glm(cbind(ncases,ncontrols) ~ alcgp + tobgp, family=binomial, data=esoph)
anova(glm.cancer_no_age, glm.cancer, test="Chi")
head(esoph)
unique(esoph$alcgp)
ages <- rep("35-44", 4)
four_pats <- data.frame(agegp = "35-44", alcgp = c("0-39g/day", "40-79", "80-119", "120+"), tobgp = "0-9g/day")
four_preds <- predict(glm.cancer, newdata = four_pats, type="response")
four_preds
plot( c(20,60,100,140), four_preds, type="b",
xlab="Alcohol consumption", ylab="Predicted probability of cancer")
glm.cancer.i <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp*tobgp, family=binomial, data=esoph)
summary(glm.cancer.i)
# intercept
glm.1 <- glm(cbind(ncases,ncontrols) ~ 1, family=binomial, data=esoph)
# intercept age
glm.2 <- glm(cbind(ncases,ncontrols) ~ agegp, family=binomial, data=esoph)
# intercept alc
glm.3 <- glm(cbind(ncases,ncontrols) ~ alcgp, family=binomial, data=esoph)
# intercept tob
glm.4 <- glm(cbind(ncases,ncontrols) ~ tobgp, family=binomial, data=esoph)
# intercept age alc
glm.5 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp, family=binomial, data=esoph)
# intercept age tob
glm.6 <- glm(cbind(ncases,ncontrols) ~ agegp + tobgp, family=binomial, data=esoph)
# intercept alc tob
glm.7 <- glm(cbind(ncases,ncontrols) ~ alcgp + tobgp, family=binomial, data=esoph)
# intercept age alc tob
glm.8 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp + tobgp, family=binomial, data=esoph)
# intercept age*alc tob
glm.9 <- glm(cbind(ncases,ncontrols) ~ agegp * alcgp + tobgp, family=binomial, data=esoph)
# intercept age alc*tob
glm.10 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp * tobgp, family=binomial, data=esoph)
# intercept alc age*tob
glm.11 <- glm(cbind(ncases,ncontrols) ~ alcgp + agegp * tobgp, family=binomial, data=esoph)
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
deviances <- c(glm.1$deviance, glm.2$deviance, glm.3$deviance,
glm.4$deviance, glm.5$deviance, glm.6$deviance,
glm.7$deviance, glm.8$deviance, glm.9$deviance,
glm.10$deviance, glm.11$deviance)
equations <- c("1",
paste(labels(terms(glm.2)), collapse = ' + '),
paste(labels(terms(glm.3)), collapse = ' + '),
paste(labels(terms(glm.4)), collapse = ' + '),
paste(labels(terms(glm.5)), collapse = ' + '),
paste(labels(terms(glm.6)), collapse = ' + '),
paste(labels(terms(glm.7)), collapse = ' + '),
paste(labels(terms(glm.8)), collapse = ' + '),
paste(labels(terms(glm.9)), collapse = ' + '),
paste(labels(terms(glm.10)), collapse = ' + '),
paste(labels(terms(glm.11)), collapse = ' + '))
df.deviances <- data.frame(setNames(deviances, equations))
colnames(df.deviances) <-  c("Equation", "Deviance")
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
deviances <- c(glm.1$deviance, glm.2$deviance, glm.3$deviance,
glm.4$deviance, glm.5$deviance, glm.6$deviance,
glm.7$deviance, glm.8$deviance, glm.9$deviance,
glm.10$deviance, glm.11$deviance)
equations <- c("1",
paste(labels(terms(glm.2)), collapse = ' + '),
paste(labels(terms(glm.3)), collapse = ' + '),
paste(labels(terms(glm.4)), collapse = ' + '),
paste(labels(terms(glm.5)), collapse = ' + '),
paste(labels(terms(glm.6)), collapse = ' + '),
paste(labels(terms(glm.7)), collapse = ' + '),
paste(labels(terms(glm.8)), collapse = ' + '),
paste(labels(terms(glm.9)), collapse = ' + '),
paste(labels(terms(glm.10)), collapse = ' + '),
paste(labels(terms(glm.11)), collapse = ' + '))
df.deviances <- data.frame(setNames(deviances, equations))
#colnames(df.deviances) <-  c("Equation", "Deviance")
df.deviances
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
deviances <- c(glm.1$deviance, glm.2$deviance, glm.3$deviance,
glm.4$deviance, glm.5$deviance, glm.6$deviance,
glm.7$deviance, glm.8$deviance, glm.9$deviance,
glm.10$deviance, glm.11$deviance)
equations <- c("1",
paste(labels(terms(glm.2)), collapse = ' + '),
paste(labels(terms(glm.3)), collapse = ' + '),
paste(labels(terms(glm.4)), collapse = ' + '),
paste(labels(terms(glm.5)), collapse = ' + '),
paste(labels(terms(glm.6)), collapse = ' + '),
paste(labels(terms(glm.7)), collapse = ' + '),
paste(labels(terms(glm.8)), collapse = ' + '),
paste(labels(terms(glm.9)), collapse = ' + '),
paste(labels(terms(glm.10)), collapse = ' + '),
paste(labels(terms(glm.11)), collapse = ' + '))
df.deviances <- data.frame(setNames(deviances, equations))
colnames(df.deviances) <-  c("Deviance")
df.deviances
p_female <- 349 / (349 + 431)
odds_female <- p_female / (1-p_female)
odds_female
p_male <- 248 / (248 + 393)
odds_male <- p_male / (1-p_male)
odds_male
odds_male / odds_female
arm::binnedplot(fitted(pima.glm), residuals(pima.glm, type="response"),
xlab="Averaged fitted probabilities",
ylab="Averaged residuals",
pch=19, col.pts="red", cex.pts=1.5,
main="Binned residuals vs. fitted plot")
plot(cooks.distance(pima.glm), type="h", lwd=2,
xlab="Observation index",
ylab="Cook's distances",
main="Cook's distances for pima data")
abline(h=1, lty=2, col="red")
exp(-5.91) / (1 + exp(-5.91))
summary(esoph)
exp(-5.91) / (1 + exp(-5.91))
glm.cancer.i <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp*tobgp, family=binomial, data=esoph)
summary(glm.cancer.i)$coef
knitr::opts_chunk$set(echo = TRUE)
options(contrasts = c("contr.treatment", "contr.treatment"))
glm.cancer <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp + tobgp, family=binomial, data=esoph)
summary(glm.cancer)$coef
exp(3.72) / (1 + exp(3.72))
# odds ratio
exp(0.3407)
# Confint
c(exp(0.3407 - 1.96*1.03), exp(0.3407 + 1.96*1.03))
exp(-5.91) / (1 + exp(-5.91))
glm.cancer_no_age <- glm(cbind(ncases,ncontrols) ~ alcgp + tobgp, family=binomial, data=esoph)
anova(glm.cancer_no_age, glm.cancer, test="Chi")
four_pats <- data.frame(agegp = "35-44", alcgp = c("0-39g/day", "40-79", "80-119", "120+"), tobgp = "0-9g/day")
four_preds <- predict(glm.cancer, newdata = four_pats, type="response")
four_preds
plot( c(20,60,100,140), four_preds, type="b",
xlab="Alcohol consumption", ylab="Predicted probability of cancer")
glm.cancer.i <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp*tobgp, family=binomial, data=esoph)
summary(glm.cancer.i)$coef
# intercept
glm.1 <- glm(cbind(ncases,ncontrols) ~ 1, family=binomial, data=esoph)
# intercept age
glm.2 <- glm(cbind(ncases,ncontrols) ~ agegp, family=binomial, data=esoph)
# intercept alc
glm.3 <- glm(cbind(ncases,ncontrols) ~ alcgp, family=binomial, data=esoph)
# intercept tob
glm.4 <- glm(cbind(ncases,ncontrols) ~ tobgp, family=binomial, data=esoph)
# intercept age alc
glm.5 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp, family=binomial, data=esoph)
# intercept age tob
glm.6 <- glm(cbind(ncases,ncontrols) ~ agegp + tobgp, family=binomial, data=esoph)
# intercept alc tob
glm.7 <- glm(cbind(ncases,ncontrols) ~ alcgp + tobgp, family=binomial, data=esoph)
# intercept age alc tob
glm.8 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp + tobgp, family=binomial, data=esoph)
# intercept age*alc tob
glm.9 <- glm(cbind(ncases,ncontrols) ~ agegp * alcgp + tobgp, family=binomial, data=esoph)
# intercept age alc*tob
glm.10 <- glm(cbind(ncases,ncontrols) ~ agegp + alcgp * tobgp, family=binomial, data=esoph)
# intercept alc age*tob
glm.11 <- glm(cbind(ncases,ncontrols) ~ alcgp + agegp * tobgp, family=binomial, data=esoph)
models <- c(glm.1, glm.2, glm.3, glm.4, glm.5, glm.6, glm.7, glm.8, glm.9, glm.10, glm.11)
deviances <- c(glm.1$deviance, glm.2$deviance, glm.3$deviance,
glm.4$deviance, glm.5$deviance, glm.6$deviance,
glm.7$deviance, glm.8$deviance, glm.9$deviance,
glm.10$deviance, glm.11$deviance)
equations <- c("1",
paste(labels(terms(glm.2)), collapse = ' + '),
paste(labels(terms(glm.3)), collapse = ' + '),
paste(labels(terms(glm.4)), collapse = ' + '),
paste(labels(terms(glm.5)), collapse = ' + '),
paste(labels(terms(glm.6)), collapse = ' + '),
paste(labels(terms(glm.7)), collapse = ' + '),
paste(labels(terms(glm.8)), collapse = ' + '),
paste(labels(terms(glm.9)), collapse = ' + '),
paste(labels(terms(glm.10)), collapse = ' + '),
paste(labels(terms(glm.11)), collapse = ' + '))
df.deviances <- data.frame(setNames(deviances, equations))
colnames(df.deviances) <-  c("Deviance")
df.deviances
confint(glm.cancer)
# odds ratio
exp(0.3407)
# Confint
c(exp(0.3407) - 1.96*1.03, exp(0.3407) + 1.96*1.03)
confint(glm.cancer)
c(exp(-0.06435894),  exp(0.7420811))
# odds ratio
exp(0.3407)
# Confint
c(exp(0.3407 - 1.96*0.205), exp(0.3407 + 1.96*0.205))
knitr::opts_chunk$set(echo = TRUE)
bt_data$p1 <- factor(bt_data$p1, levels=players)
setwd("~/Documents/HSpring21/Stat98/final_project")
